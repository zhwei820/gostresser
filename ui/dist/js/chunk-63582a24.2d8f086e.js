(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63582a24"],{"1f3c":function(e,t,r){},"2dc9":function(e,t,r){"use strict";r.d(t,"c",function(){return i}),r.d(t,"d",function(){return a}),r.d(t,"b",function(){return l}),r.d(t,"e",function(){return o}),r.d(t,"a",function(){return u});var n=r("97af"),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n["a"].get("/apis",{params:e})},a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n["a"].get("/apis/".concat(e,"/"),{params:t})},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n["a"].delete("/apis/".concat(e,"/"),{params:t})},o=function(e,t){return n["a"].put("/apis/".concat(e,"/"),t)},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n["a"].post("/apis/",e)}},"3afd":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Card",[r("Form",{ref:"formDynamic",staticStyle:{width:"850px"},attrs:{model:e.formDynamic,"label-width":100}},[r("FormItem",{attrs:{label:"Name",prop:"name",required:""}},[r("Col",{attrs:{span:"12"}},[r("Input",{attrs:{placeholder:"Enter your name"},model:{value:e.formDynamic.name,callback:function(t){e.$set(e.formDynamic,"name",t)},expression:"formDynamic.name"}})],1)],1),r("FormItem",{attrs:{label:"Active",prop:"active"}},[r("i-switch",{attrs:{size:"large"},model:{value:e.formDynamic.active,callback:function(t){e.$set(e.formDynamic,"active",t)},expression:"formDynamic.active"}},[r("span",{attrs:{slot:"open"},slot:"open"},[e._v("ON")]),r("span",{attrs:{slot:"close"},slot:"close"},[e._v("OFF")])])],1),r("Proxy",{attrs:{value:e.formDynamic.proxy,title:"Proxy"},on:{"update:value":function(t){e.$set(e.formDynamic,"proxy",t)}}}),r("Card",[r("p",{attrs:{slot:"title"},slot:"title"},[e._v("Plugins")]),e._l(e.formDynamic.plugins,function(t,n){return r("FormItem",{key:n,attrs:{label:"Plugin"}},[r("Row",[r("Col",{attrs:{span:"10"}},[r("Button",{attrs:{id:"btn",type:"primary"},on:{click:function(t){e.showPluginModal(n)}}},[e._v("\n                "+e._s(t.name)+"\n              ")])],1),r("Col",{attrs:{span:"2",offset:"1"}},[r("Button",{attrs:{type:"warning"},on:{click:function(t){e.handleRemovePlugin(n)}}},[e._v("del")])],1)],1)],1)}),r("FormItem",[r("Row",[r("Col",{attrs:{span:"6"}},[r("Button",{attrs:{type:"dashed",long:"",icon:"md-add"},on:{click:e.showSelectPluginModal}},[e._v("Add Plugin")])],1)],1)],1)],2),r("FormItem",{attrs:{label:"health_check",prop:"health_check",required:""}},[r("Col",{attrs:{span:"12"}},[r("Input",{attrs:{placeholder:"health_check url"},model:{value:e.formDynamic.health_check.url,callback:function(t){e.$set(e.formDynamic.health_check,"url",t)},expression:"formDynamic.health_check.url"}})],1),r("Col",{attrs:{span:"2",offset:"1"}},[r("span",{staticStyle:{float:"right","margin-right":"10px"}},[e._v(" timeout ")])]),r("Col",{attrs:{span:"2"}},[r("Input",{attrs:{type:"text",placeholder:"timeout"},model:{value:e.formDynamic.health_check.timeout,callback:function(t){e.$set(e.formDynamic.health_check,"timeout",t)},expression:"formDynamic.health_check.timeout"}})],1)],1),r("FormItem",[r("Button",{attrs:{type:"primary"},on:{click:function(t){e.handleSubmit("formDynamic")}}},[e._v("Submit")])],1)],1)],1)],1)},i=[],a=(r("ac6a"),r("386d"),r("96cf"),r("3b8d")),l=(r("7f7f"),r("2dc9")),o=r("30fc"),u=r("f007"),c=r("f88b");function s(e){return[{title:"Plugin Name",key:"pluginName",defaultValue:e,type:"radio",rule:{required:!0,message:"Name?",trigger:"blur"},options:[{value:"body_limit",text:"Body Limit"},{value:"cb",text:"Circuit Breaker"},{value:"rate_limit",text:"Rate Limiting"},{value:"oauth2",text:"oauth2"}]}]}var m=r("a064"),p={name:"ServiceDetail",components:{InputForm:o["a"],Proxy:u["a"]},data:function(){return{pluginName:"body_limit",pluginIndex:-1,copy:"",OauthList:[],formDynamic:{name:"",active:!0,proxy:{preserve_host:!1,listen_path:"",upstreams:{balancing:"roundrobin",targets:[{target:"",weight:0}]},insecure_skip_verify:!1,strip_path:!1,append_path:!1,methods:["GET"],hosts:null,forwarding_timeouts:{dial_timeout:"0s",response_header_timeout:"0s"}},plugins:[],health_check:{url:"",timeout:3}},serviceData:{}}},computed:{name:function(){if(!this.copy){var e=this.$route.params.name;return"null"===e?null:e}return null}},methods:{handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){e?(t.$Message.success("Success!"),t.createOrUpdateService(t.formDynamic)):t.$Message.error("Fail!")})},createOrUpdateService:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.errors={},e.prev=1,this.name){e.next=7;break}return e.next=5,Object(l["a"])(t);case 5:e.next=9;break;case 7:return e.next=9,Object(l["e"])(this.name,t);case 9:this.$router.push({name:"serviceList"}),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](1),console.log(e.t0),this.errors=e.t0.data||{};case 16:case"end":return e.stop()}},e,this,[[1,12]])}));function t(t){return e.apply(this,arguments)}return t}(),fetchServiceByName:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var r,n,i,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["d"])(t);case 2:return r=e.sent,this.formDynamic=r,this.formDynamic.plugins||(this.formDynamic.plugins=[]),n=new URLSearchParams(window.location.search),this.copy=n.get("copy"),this.copy&&(this.formDynamic.name=""),e.next=10,Object(m["c"])(t);case 10:i=e.sent,this.OauthList=[],i.forEach(function(e){a.OauthList.push({value:e.name,text:e.name})});case 13:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),showPluginModal:function(e){var t=this,r=this.$createElement;this.pluginIndex=e,console.log(this.formDynamic.plugins),console.log(e),this.formList=Object(c["c"])(this.formDynamic.plugins[e],this.OauthList),this.$Modal.confirm({title:"Edit Plugin",width:600,onOk:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),onCancel:function(){},render:function(){return r(o["a"],{attrs:{showSubmit:!1,formList:t.formList,errors:{}},on:{change:t.handleFormDataChange}})}})},showSelectPluginModal:function(){var e=this,t=this.$createElement;this.formList=s(this.pluginName),this.$Modal.confirm({title:"Select Plugin",width:600,onOk:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.formDynamic.plugins.push(Object(c["b"])(e.pluginName));case 1:case"end":return t.stop()}},t,this)}));function r(){return t.apply(this,arguments)}return r}(),onCancel:function(){},render:function(){return t(o["a"],{attrs:{showSubmit:!1,formList:e.formList,errors:{}},on:{change:e.handleSelectPluginChange}})}})},handleSelectPluginChange:function(e){this.pluginName=e.pluginName},handleFormDataChange:function(e){this.formDynamic.plugins[this.pluginIndex]=e},handleRemovePlugin:function(e){this.formDynamic.plugins.splice(e,1)}},created:function(){this.name&&this.fetchServiceByName(this.name)}},d=p,f=(r("c4b1"),r("2877")),h=Object(f["a"])(d,n,i,!1,null,null,null);t["default"]=h.exports},c4b1:function(e,t,r){"use strict";var n=r("1f3c"),i=r.n(n);i.a},f88b:function(e,t,r){"use strict";r("7f7f");function n(){return{name:"body_limit",enabled:!0,config:{limit:"40M"}}}function i(e){return[{title:"Name",key:"name",defaultValue:e["name"],type:"html",rule:{required:!0,message:"Name?",trigger:"blur"}},{title:"Enabled",key:"enabled",defaultValue:e["enabled"],type:"switch",rule:{required:!0,message:"Enabled?",trigger:"blur"},props:{placeholder:"Enabled?"}},{title:"Limit",key:"config.limit",defaultValue:e.config.limit,type:"input",rule:{required:!0,message:"1M, 100K ?",trigger:"blur"},props:{placeholder:"1M, 100K ?"}}]}function a(){return{name:"cb",enabled:!0,config:{name:"",timeout:1e3,max_concurrent_requests:100,error_percent_threshold:50,request_volume_threshold:20,sleep_window:5e3,predicate:"statusCode == 0 || statusCode >= 500"}}}function l(e){return[{title:"Name",key:"name",defaultValue:e["name"],type:"html",rule:{required:!0,message:"Name?",trigger:"blur"}},{title:"Enabled",key:"enabled",defaultValue:e["enabled"],type:"switch",rule:{required:!0,message:"Enabled?",trigger:"blur"},props:{placeholder:"Enabled?"}},{title:"name",key:"config.name",defaultValue:e.config.name,type:"input",rule:{required:!0,message:"",trigger:"blur"},props:{placeholder:""}},{title:"timeout",key:"config.timeout",defaultValue:e.config.timeout,type:"input",rule:{required:!0,message:"",trigger:"blur"},props:{placeholder:""}},{title:"max_concurrent_requests",key:"config.max_concurrent_requests",defaultValue:e.config.max_concurrent_requests,type:"input",rule:{required:!0,message:"",trigger:"blur"},props:{placeholder:""}},{title:"error_percent_threshold",key:"config.error_percent_threshold",defaultValue:e.config.error_percent_threshold,type:"input",rule:{required:!0,message:"",trigger:"blur"},props:{placeholder:""}},{title:"request_volume_threshold",key:"config.request_volume_threshold",defaultValue:e.config.request_volume_threshold,type:"input",rule:{required:!0,message:"",trigger:"blur"},props:{placeholder:""}},{title:"sleep_window",key:"config.sleep_window",defaultValue:e.config.sleep_window,type:"input",rule:{required:!0,message:"",trigger:"blur"},props:{placeholder:""}},{title:"predicate",key:"config.predicate",defaultValue:e.config.predicate,type:"input",rule:{required:!0,message:"",trigger:"blur"},props:{placeholder:""}}]}function o(){return{name:"rate_limit",enabled:!0,config:{limit:"10-S",policy:"local",redis:{dsn:"",prefix:""}}}}function u(e){return[{title:"Name",key:"name",defaultValue:e["name"],type:"html",rule:{required:!0,message:"Name?",trigger:"blur"}},{title:"Enabled",key:"enabled",defaultValue:e["enabled"],type:"switch",rule:{required:!0,message:"Enabled?",trigger:"blur"},props:{placeholder:"Enabled?"}},{title:"limit - eg: 5-S, 10-M, 1000-H",key:"config.limit",defaultValue:e.config.limit,type:"input",rule:{required:!0,message:"",trigger:"blur"},props:{placeholder:""}},{title:"policy",key:"config.policy",defaultValue:e.config.policy,type:"radio",rule:{required:!0,message:"Name?",trigger:"blur"},options:[{value:"local",text:"local"},{value:"redis",text:"redis"}]},{title:"redis.dsn",key:"config.redis.dsn",defaultValue:e.config.redis.dsn,type:"input",rule:{required:!0,message:"",trigger:"blur"},props:{placeholder:""}},{title:"redis.prefix",key:"config.redis.prefix",defaultValue:e.config.redis.prefix,type:"input",rule:{required:!0,message:"",trigger:"blur"},props:{placeholder:""}}]}function c(){return{name:"oauth2",enabled:!0,config:{server_name:""}}}function s(e,t){return[{title:"Name",key:"name",defaultValue:e["name"],type:"html",rule:{required:!0,message:"Name?",trigger:"blur"}},{title:"Enabled",key:"enabled",defaultValue:e["enabled"],type:"switch",rule:{required:!0,message:"Enabled?",trigger:"blur"},props:{placeholder:"Enabled?"}},{title:"server_name",key:"config.server_name",defaultValue:e.config.server_name,type:"select",options:t}]}function m(e){return[{title:"Api Name",key:"name"},{title:"Listen Path",key:"listen_path",render:function(e,t){return e("span",[t.row.proxy.listen_path])}},{title:"Active",key:"active",render:function(e,t){var r=""+t.row.active,n=t.row.active?"success":"magenta";return e("span",[e("tag",{attrs:{color:n}},[" ",r])])}},{title:"Operations",key:"action",width:250,align:"center",render:function(t,r){return t("div",[t("i-button",{attrs:{type:"primary"},on:{click:e.copy.bind(e,r.row)}},["Copy"]),t("i-button",{attrs:{type:"primary"},on:{click:e.edit.bind(e,r.row)}},["Edit"]),t("i-button",{attrs:{type:"error"},on:{click:e.remove.bind(e,r.row)}},["Delete"])])}}]}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{body_limit:i,cb:l,rate_limit:u,oauth2:s}[e.name].call(null,e,t)}function d(e){return{body_limit:n,cb:a,rate_limit:o,oauth2:c}[e].call(null)}r.d(t,"a",function(){return m}),r.d(t,"c",function(){return p}),r.d(t,"b",function(){return d})}}]);
//# sourceMappingURL=chunk-63582a24.2d8f086e.js.map